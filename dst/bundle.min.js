module.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n=t[1]||"",i=t[3];if(!i)return n;if(e&&"function"==typeof btoa){var r=(a=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),o=i.sources.map(function(t){return"/*# sourceURL="+i.sourceRoot+t+" */"});return[n].concat(o).concat([r]).join("\n")}var a;return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];null!=o&&(i[o]=!0)}for(r=0;r<t.length;r++){var a=t[r];null!=a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(t,e,n){var i,r,o={},a=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=i.apply(this,arguments)),r}),s=function(t){var e={};return function(t,n){if("function"==typeof t)return t();if(void 0===e[t]){var i=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,n);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}}(),l=null,c=0,h=[],u=n(5);function f(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=o[i.id];if(r){r.refs++;for(var a=0;a<r.parts.length;a++)r.parts[a](i.parts[a]);for(;a<i.parts.length;a++)r.parts.push(y(i.parts[a],e))}else{var s=[];for(a=0;a<i.parts.length;a++)s.push(y(i.parts[a],e));o[i.id]={id:i.id,refs:1,parts:s}}}}function d(t,e){for(var n=[],i={},r=0;r<t.length;r++){var o=t[r],a=e.base?o[0]+e.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};i[a]?i[a].parts.push(s):n.push(i[a]={id:a,parts:[s]})}return n}function p(t,e){var n=s(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=h[h.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),h.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=s(t.insertAt.before,n);n.insertBefore(e,r)}}function x(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=h.indexOf(t);e>=0&&h.splice(e,1)}function m(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var i=function(){0;return n.nc}();i&&(t.attrs.nonce=i)}return g(e,t.attrs),p(t,e),e}function g(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function y(t,e){var n,i,r,o;if(e.transform&&t.css){if(!(o="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=o}if(e.singleton){var a=c++;n=l||(l=m(e)),i=b.bind(null,n,a,!1),r=b.bind(null,n,a,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",g(e,t.attrs),p(t,e),e}(e),i=function(t,e,n){var i=n.css,r=n.sourceMap,o=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||o)&&(i=u(i));r&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var a=new Blob([i],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}.bind(null,n,e),r=function(){x(n),n.href&&URL.revokeObjectURL(n.href)}):(n=m(e),i=function(t,e){var n=e.css,i=e.media;i&&t.setAttribute("media",i);if(t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),r=function(){x(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=a()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=d(t,e);return f(n,e),function(t){for(var i=[],r=0;r<n.length;r++){var a=n[r];(s=o[a.id]).refs--,i.push(s)}t&&f(d(t,e),e);for(r=0;r<i.length;r++){var s;if(0===(s=i[r]).refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete o[s.id]}}}};var F,v=(F=[],function(t,e){return F[t]=e,F.filter(Boolean).join("\n")});function b(t,e,n,i){var r=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=v(e,r);else{var o=document.createTextNode(r),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(o,a[e]):t.appendChild(o)}}},function(t,e,n){"use strict";n.r(e);n(3),n(6);function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const r=(t,e,n,i,r)=>t<e?i:t>n?r:(t-e)*(r-i)/(n-e)+i;function o(t,e){let n;return 3===(n=t.substring(1).split("")).length&&(n=[n[0],n[0],n[1],n[1],n[2],n[2]]),`rgba(${[(n=`0x4${n.join("")}`)>>16&255,n>>8&255,255&n].join(",")}, ${e})`}e.default=class{constructor(t){i(this,"canvasEl",void 0),i(this,"fontRenderEl",void 0),i(this,"renderStartedAt",void 0),i(this,"state",{canvasWidth:600,canvasHeight:600,image:null,imageURL:"",text:"",textLines:[],textLettersFade:[],maxTextLines:0,textFontFamily:"Kaushan Script",textFontSize:12,textFontLineHeight:0,textEffect:"fade",textFullyRendered:!1,textLastRenderedLetter:"",textFrame:1,textFrameOpacity:.5,textFrameOpacityStep:.5,textLettersOpacity:0,textLettersOpacityStep:.05,textFramePosition:0,textFramePositionStep:.1,textAlign:"right",textVerticalAlign:"top",author:"",authorLines:[],authorFontFamily:"Nickainley",authorFontSize:6,authorFontLineHeight:0,authorEffect:"fade",authorFullyRendered:!1,authorLastRenderedLetter:"",authorFrame:1,authorFrameOpacity:.1,authorFrameOpacityStep:.1,authorFramePosition:0,authorFramePositionStep:.1,authorAlign:"left",authorVerticalAlign:"bottom",animate:!0,frameQuality:.93,overlay:"border",marginTop:300,marginLeft:50,color:"#FFF"}),i(this,"setCanvasSize",()=>{const{canvasWidth:t,canvasHeight:e}=this.state;this.canvasEl&&(this.canvasEl.width=t,this.canvasEl.height=e)}),i(this,"loadImage",()=>new Promise((t,e)=>{const{imageURL:n}=this.state,i=new Image;i.onload=(()=>{this.newState={image:i},t()}),i.onerror=(t=>{e(t)}),i.src=n})),i(this,"renderImage",()=>{if(!this.context)return;const{image:t,canvasWidth:e,canvasHeight:n}=this.state;if(t){let i,r,o=t.width,a=t.height;const s=o/a;o>a?(a=n,r=0,i=-((o=n*s)-e)/2):(o=e,i=0,r=-((a=e/s)-n)/2),this.context.drawImage(t,i,r,o,a)}}),i(this,"renderOverlay",()=>{if(!this.context)return;const{overlay:t,canvasWidth:e,canvasHeight:n,marginLeft:i,color:r}=this.state;"solid"===t&&(this.context.fillStyle=o("#000",.5),this.context.fillRect(i/2,i/2,e-i,n-i)),"border"===t&&(this.context.lineWidth=4,this.context.strokeStyle=r,this.context.rect(i/2,i/2,e-i,n-i),this.context.stroke()),"lines"===t&&(this.context.lineWidth=4,this.context.strokeStyle=r,this.context.beginPath(),this.context.moveTo(i/2,i/2),this.context.lineTo(e-i/2,i/2),this.context.stroke(),this.context.beginPath(),this.context.moveTo(i/2,n-i/2),this.context.lineTo(e-i/2,n-i/2),this.context.stroke())}),i(this,"getFont",(t,e)=>`${t}rem "${e}"`),i(this,"getFontProps",(t,e,n,i=!0)=>{if(!this.fontRenderEl||!this.context)return{};const{marginTop:r,marginLeft:o,canvasWidth:a,canvasHeight:s}=this.state,l=this.getFont(n,e);this.context.font=l,this.fontRenderEl.style.font=l,this.fontRenderEl.innerText=t;const c=this.fontRenderEl.offsetHeight,h=c+.2*c,u=Math.floor((s-r)/h);if(i){const r=[];let s="";const l=t.split(" ");return l.forEach((t,e)=>{this.context.measureText(`${s} ${t}`).width>a-o?(r.push(s),s=t):s+=""===s?t:` ${t}`,e===l.length-1&&r.push(s)}),r.length>u?this.getFontProps(t,e,n-1,i):{fontSize:n,fontLineHeight:h,maxTextLines:u,textLines:r}}return this.context.measureText(t).width>a-o?this.getFontProps(t,e,n-1,i):{fontSize:n,fontLineHeight:h}}),i(this,"loadText",()=>new Promise(t=>{if(!this.context)return;const{textFontFamily:e,textFontSize:n,authorFontFamily:i,authorFontSize:r}=this.state,o=this.state.text.trim(),a=this.state.author.trim();this.context.textBaseline="middle";const s=this.getFontProps(o,e,n),l=[];s.textLines.forEach(t=>{const e=Math.ceil(t.length/(5*Math.random()+10)),n=[];for(let i=0,r=t.length;i<r;i+=e)n.push(i);l.push(n)});const c=this.getFontProps(a,i,r,!1);this.newState={text:o,textLettersFade:l,textFontSize:s.fontSize,textFontLineHeight:s.fontLineHeight,maxTextLines:s.maxTextLines,textLines:s.textLines,author:a,authorFontSize:c.fontSize,authorFontLineHeight:c.fontLineHeight},t()})),i(this,"animationType",(t,e,n,i,r,a,s=!0)=>{if(!this.context)return"";const{color:l}=this.state;let c;if(t>n+e.length)this.context.fillStyle=l,this.context.fillText(e,r,a);else{let h=t;s&&(h=t-n);const u=e.substr(0,h-1);u.length&&(this.context.fillStyle=l,this.context.fillText(u,r,a));const f=this.context.measureText(u);c=e.substr(h-1,1),this.context.fillStyle=o(l,i),this.context.fillText(c,r+f.width,a)}return c}),i(this,"animationFade",(t,e,n,i)=>{if(!this.context)return;const{color:r}=this.state;this.context.fillStyle=o(r,e),this.context.fillText(t,n,i)}),i(this,"animationFadeLine",(t,e,n,i,r,o)=>{if(!this.context)return;const{color:a}=this.state;t-1>n&&(this.context.fillStyle=a,this.context.fillText(e,r,o)),t-1===n&&this.animationFade(e,i,r,o)}),i(this,"animationSlide",(t,e,n,i,a,s)=>{if(!this.context)return;const{color:l,marginLeft:c}=this.state,h=r(n,0,1,c,0);this.context.fillStyle=o(l,e),"x"===s?this.context.fillText(t,i-h,a):this.context.fillText(t,i,a-h)}),i(this,"animationSlideLine",(t,e,n,i,r,o,a,s)=>{if(!this.context)return;const{color:l}=this.state;t-1>n&&(this.context.fillStyle=l,this.context.fillText(e,o,a)),t-1===n&&this.animationSlide(e,i,r,o,a,s)}),i(this,"renderText",()=>{if(!this.context)return;const{animate:t,textEffect:e,textFontSize:n,textFontFamily:i,textFontLineHeight:a,textLines:s,maxTextLines:l,textLettersFade:c,textFrame:h,textFrameOpacity:u,textFrameOpacityStep:f,textLettersOpacity:d,textLettersOpacityStep:p,textFramePosition:x,textFramePositionStep:m,authorFontLineHeight:g,canvasWidth:y,canvasHeight:F,color:v,textAlign:b,textVerticalAlign:S,authorVerticalAlign:L,marginLeft:w}=this.state;this.context.font=this.getFont(n,i);let U=0,R=0,T="";for(let n=(l-s.length)/2,i=n+s.length;n<i;n++){const i=s[U],f=this.context.measureText(i);let p=w/2;"center"===b?p=(y-f.width)/2:"right"===b&&(p=y-f.width-w/2);let m=r(a,40,150,30,0);const O=l*a;"center"===S?m=(F-O)/2:"bottom"===S&&(m=F-O-g/2);let E=n*a+a/2+m;if("center"!==S&&"bottom"!==S||S!==L||(E-=g),t){if("type"===e&&(T=this.animationType(h,i,R,u,p,E)))break;if("fade lines"===e&&(this.animationFadeLine(h,i,U,u,p,E),h-1===U))break;if("fade letters"===e){const t=c[U];for(let e=1,r=i.length;e<=r;n++){const n=this.context.measureText(i.substr(0,e-1)),r=i.substr(e-1,1);t.includes(e)?this.context.fillStyle=o(v,d):this.context.fillStyle=o(v,u),this.context.fillText(r,p+n.width,E)}}"fade"===e&&this.animationFade(i,u,p,E),"slide lines"===e&&this.animationSlideLine(h,i,U,u,x,p,E,"x"),"append lines"===e&&this.animationSlideLine(h,i,U,u,x,p,E,"y")}else this.context.fillStyle=v,this.context.fillText(i,p,E);R+=i.length,U++}switch(e){case"type":{const e=s.reduce((t,e)=>t+e.length,0),n=" "===T||u>=1;this.newState={textFullyRendered:!t||R===e,textFrame:n?h+1:h,textFrameOpacity:n?f:u+f,textLastRenderedLetter:T};break}case"fade lines":this.newState={textFullyRendered:!t||h>s.length,textFrame:u>=1?h+1:h,textFrameOpacity:u>=1?f:u+f};break;case"fade letters":this.newState={textFullyRendered:!t||1===d,textFrame:d>=1?h+1:h,textFrameOpacity:u>=1?1:u+f,textLettersOpacity:d>=1?1:d+p};break;case"fade":this.newState={textFullyRendered:!t||1===u,textFrame:u>=1?h+1:h,textFrameOpacity:u>=1?1:u+f};break;case"slide lines":case"append lines":this.newState={textFullyRendered:!t||h>s.length,textFrame:x>=1?h+1:h,textFrameOpacity:u>=1?f:u+f,textFramePosition:x>=1?0:Number((x+m).toFixed(1))}}}),i(this,"renderAuthor",()=>{if(!this.context)return;const{animate:t,authorEffect:e,canvasHeight:n,authorFontSize:i,authorFontFamily:r,authorFontLineHeight:o,author:a,textLines:s,maxTextLines:l,textFontLineHeight:c,textVerticalAlign:h,authorFrame:u,authorFrameOpacity:f,authorFrameOpacityStep:d,authorFramePosition:p,authorFramePositionStep:x,canvasWidth:m,color:g,authorAlign:y,authorVerticalAlign:F,marginLeft:v}=this.state;this.context.font=this.getFont(i,r);const b=this.context.measureText(a);let S=v/2;"center"===y?S=(m-b.width)/2:"right"===y&&(S=m-b.width-v/2);let L=1.3*o;const w=l*c;"center"===F&&"center"===h?L=(n-w)/2:"bottom"===F&&(L=n-w-o/2);const U=((l-s.length)/2+s.length-1)*c+c+L;let R="";switch(t?("type"===e&&(R=this.animationType(u,a,u,f,S,U,!1)),"fade"===e&&this.animationFade(a,f,S,U),"slide"===e&&this.animationSlide(a,f,p,S,U,"x"),"append"===e&&this.animationSlide(a,f,p,S,U,"y")):(this.context.fillStyle=g,this.context.fillText(a,S,U)),e){case"type":{const e=" "===R||f>=1;this.newState={authorFullyRendered:!t||u>a.length,authorFrame:e?u+1:u,authorFrameOpacity:e?d:f+d,authorLastRenderedLetter:R};break}case"fade":this.newState={authorFullyRendered:!t||f>1,authorFrame:f>=1?u+1:u,authorFrameOpacity:f>=1?d:f+d};break;case"slide":case"append":this.newState={authorFullyRendered:!t||p>=1,authorFrame:p>=1?u+1:u,authorFrameOpacity:f>=1?1:f+d,authorFramePosition:p>=1?0:p+x}}}),i(this,"render",()=>{const{image:t,textFullyRendered:e}=this.state;t?(this.renderImage(),this.renderOverlay(),this.renderText(),e&&this.renderAuthor(),this.postRender()):Promise.all([this.loadImage(),this.loadText()]).then(()=>{this.render()}).catch(t=>{console.error(t)})}),i(this,"postRender",()=>{const{textEffect:t,textFullyRendered:e,textLastRenderedLetter:n,authorEffect:i,authorFullyRendered:r,authorLastRenderedLetter:o,frameQuality:a}=this.state;if(this.canvasEl&&window.puppeteer&&("type"!==t||""!==n&&" "!==n||"type"!==i||""!==o&&" "!==o)){const t=this.canvasEl.toDataURL("image/jpeg",a);console.log(t)}e&&r?(console.log("Render time: ",(Date.now()-this.renderStartedAt)/1e3),console.log("puppeteer: Finish")):window.puppeteer?this.render():requestAnimationFrame(()=>{this.render()})}),this.newState=t;let e=t.container;"string"==typeof t.container&&(e=document.querySelector(t.container)),e?(this.renderStartedAt=Date.now(),this.canvasEl=document.createElement("canvas"),this.fontRenderEl=document.createElement("div"),this.fontRenderEl.id="canvas-font-renderer",e.appendChild(this.canvasEl),e.appendChild(this.fontRenderEl),this.setCanvasSize()):console.error("Wrong container selector")}set newState(t){Object.keys(t).forEach(e=>{this.state[e]=t[e]})}get context(){return this.canvasEl?this.canvasEl.getContext("2d"):null}}},function(t,e,n){var i=n(4);"string"==typeof i&&(i=[[t.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(1)(i,r);i.locals&&(t.exports=i.locals)},function(t,e,n){(t.exports=n(0)(!1)).push([t.i,"html, body, form, fieldset, ul, dl, dt, dd, table, td, th, img, menu {\n    margin: 0;\n    padding: 0;\n    border: none;\n}\n\nhtml {\n    height: 100%;\n    width: 100%;\n    font-size: 10px;\n}\n\nbody {\n    background-color: #333;\n}\n\n#canvas-font-renderer {\n    position: absolute;\n    left: 0;\n    top: -1000rem;\n    white-space: nowrap;\n}\n",""])},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,i=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var r,o=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?t:(r=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:i+o.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")})}},function(t,e,n){var i=n(7);"string"==typeof i&&(i=[[t.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(1)(i,r);i.locals&&(t.exports=i.locals)},function(t,e,n){e=t.exports=n(0)(!1);var i=n(8),r=i(n(9)),o=i(n(10));e.push([t.i,"/* latin */\n@font-face {\n    font-family: 'Kaushan Script';\n    font-style: normal;\n    font-weight: 400;\n    src: url("+r+") format('woff2');\n    unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n}\n@font-face {\n    font-family: 'Nickainley';\n    font-style: normal;\n    font-weight: 400;\n    src: url("+o+") format('ttf');\n    unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n}\n",""])},function(t,e,n){"use strict";t.exports=function(t,e){return"string"!=typeof t?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),/["'() \t\n]/.test(t)||e?'"'+t.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':t)}},function(t,e,n){t.exports=n.p+"/fonts/KaushanScript-Regular.woff2"},function(t,e,n){t.exports=n.p+"/fonts/Nickainley.ttf"}]);
//# sourceMappingURL=bundle.min.js.map